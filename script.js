const translations = {
  ru: {
    logo: "Minecraft Launcher",
    ely_profile: "Профиль <u>Ely.by</u>",
    main_title: "Лаунчер Minecraft",
    main_subtitle: "Стабильный, быстрый и простой",
    download_win: "Скачать Лаунчер",
    play_online: "Сыграть онлайн",
    players_today: "игроков сегодня",
    players_online: "игроков онлайн",
    players_month: "игроков за месяц",
    screenshots: "Скриншоты",
    faq_title: "Часто задаваемые вопросы",
    faq_q1: "Это бесплатно?",
    faq_a1: "Да, лаунчер полностью бесплатный.<br>У нас нет и никогда не будет платных функций.",
    faq_q2: "Есть ли вирусы?",
    faq_a2_1: "Minecraft Launcher полностью безопасен. Если вы скачаете лаунчер с этой страницы, мы гарантируем, что он не будет содержать никаких вирусов.",
    faq_a2_2: 'Боитесь за безопасность? Исходный код лаунчера доступен <a href="https://dl.llaun.ch/legacy/source">по этой ссылке</a>.',
    faq_q3: "Можно ли устанавливать читы?",
    faq_a3: "Да, лаунчер позволяет запускать любые версии игры без ограничений.<br>Мы не рекомендуем использовать читы там, где это запрещено.",
    faq_q4: "Можно ли устанавливать моды и сборки?",
    faq_a4: "Да, можно. В лаунчере можно выбрать версии с Forge и Fabric, а также устанавливать свои сборки вручную.",
    faq_q5: "Можно ли менять скины?",
    faq_a5: "Да, конечно! Для этого можно использовать профиль Ely.by, он доступен по кнопке справа сверху на вашем экране.",
    faq_q6: "Есть ли портативная сборка?",
    faq_a6: 'Да, есть. Можно <a href="https://dl.llaun.ch/legacy/portable">скачать портативную сборку здесь</a>.',
    faq_q7: "Не запускается игра. Что делать?",
    faq_a7: "Обратитесь в нашу бесплатную поддержку по ссылке ниже.",
    support_title: "Поддержка",
    support_text: "Вы всегда можете обратиться к нам за помощью, если что-то не работает или работает не так, как вы ожидаете.<br>Наша опытная команда разработчиков и волонтёров постарается вам помочь.",
    form_title: "Связаться с поддержкой",
    form_name: "Ваше имя",
    form_email: "Email",
    form_message: "Сообщение",
    form_send: "Отправить",
    vk: "ВКонтакте",
    footer_text: `Игра имеет возрастное ограничение 6+. Возрастная маркировка при игре по сети задаётся владельцами серверов 
и контент на них<br>может быть запрещён для детей. 
<a href="https://www.minecraft.net/ru-ru/get-minecraft/age-rating" target="_blank">
Подробнее о возрастных ограничениях на сайте Minecraft.
</a> <br>
НЕ ЯВЛЯЕТСЯ ОФИЦИАЛЬНЫМ ПРОДУКТОМ MINECRAFT. НЕ ОДОБРЕНО И НЕ СВЯЗАНО С MOJANG ИЛИ MICROSOFT. <br>
Minecraft Launcher никоим образом не аффилирован с Mojang Studios и не должен считаться проектом, одобренным Mojang Studios. <br>
По любым вопросам, предложениям или жалобам обращайтесь:
<a href="mailto:support@support.com">support@support.com</a> <br>`,
    download_title: "Скачать",
    download_windows: "Windows",
    recommended: "Рекомендуется",
    win_step1: "Скачайте установщик, нажав на кнопку ниже",
    win_step2: "Запустите его и следуйте инструкциям",
    download_installer: "Скачать установщик",
    download_mac: "macOS",
    mac_note: "на процессорах Intel (x64) или через Rosetta",
    mac_step1: "Скачайте образ, нажав на кнопку ниже",
    mac_step2: "Запустите его и установите лаунчер",
    download_image: "Скачать образ",
    download_java: "Установка Java вручную",
    java_step1: "Загрузите и установите свежую версию Java для вашей платформы, например с сайта <a href=\"https://adoptium.net/\" target=\"_blank\">Adoptium</a>",
    java_step2: "Скачайте и запустите <a href=\"https://dl.llaun.ch/legacy/bootstrap\">.jar-файл</a> лаунчера. Он установит всё необходимое",
    about_title: "О проекте",
    about_text: `Этот проект был создан студентами 
    <a href="https://intc.kz/ru/" target="_blank">Инновационного технического колледжа г. Алматы</a> — 
    Айтматовым Самандаром и Исмаиловым Асанали.  
    Цель проекта — продемонстрировать навыки в веб-разработке, получить высший балл и выйти на повышенную стипендию.`,
    about_samandar: "Айтматов Самандар",
    about_asanali: "Исмаилов Асанали",
    about_contacts: "Контакты:",
    footer_about: "© 2025 Minecraft Launcher. Проект для Инновационного технического колледжа.",
    about_btn: "О нас"
  },
  en: {
    logo: "Minecraft Launcher",
    ely_profile: "Profile <u>Ely.by</u>",
    main_title: "Minecraft Launcher",
    main_subtitle: "Stable, fast and simple",
    download_win: "Download Launcher",
    play_online: "Play Online",
    players_today: "players today",
    players_online: "players online",
    players_month: "players this month",
    screenshots: "Screenshots",
    faq_title: "Frequently Asked Questions",
    faq_q1: "Is it free?",
    faq_a1: "Yes, the launcher is completely free.<br>We do not and never will have paid features.",
    faq_q2: "Are there viruses?",
    faq_a2_1: "Minecraft Launcher is completely safe. If you download it from this page, we guarantee it will not contain any viruses.",
    faq_a2_2: 'Worried about security? The launcher\'s source code is available <a href="https://dl.llaun.ch/legacy/source">here</a>.',
    faq_q3: "Can I install cheats?",
    faq_a3: "Yes, the launcher allows running any game version without restrictions.<br>We do not recommend using cheats where it is forbidden.",
    faq_q4: "Can I install mods and modpacks?",
    faq_a4: "Yes. The launcher supports Forge and Fabric versions, and you can also install custom modpacks manually.",
    faq_q5: "Can I change skins?",
    faq_a5: "Yes, of course! You can use an Ely.by profile, available via the button in the top-right corner.",
    faq_q6: "Is there a portable version?",
    faq_a6: 'Yes, there is. You can <a href="https://dl.llaun.ch/legacy/portable">download it here</a>.',
    faq_q7: "The game won’t start. What should I do?",
    faq_a7: "Please contact our free support below.",
    support_title: "Support",
    support_text: "You can always contact us if something doesn’t work or doesn’t behave as expected.<br>Our experienced team of developers and volunteers will do their best to help you.",
    form_title: "Contact Support",
    form_name: "Your Name",
    form_email: "Email",
    form_message: "Message",
    form_send: "Send",
    vk: "VK",
    footer_text: `The game is rated 6+. Server owners define the content on multiplayer servers, <br>and it may be unsuitable for children. 
<a href="https://www.minecraft.net/en-us/get-minecraft/age-rating" target="_blank">
Read more about age restrictions on the Minecraft website.
</a> <br>
NOT AN OFFICIAL MINECRAFT PRODUCT. NOT APPROVED BY OR ASSOCIATED WITH MOJANG OR MICROSOFT. <br>
Minecraft Launcher is not affiliated with Mojang Studios and should not be considered an approved project. <br>
For any questions, suggestions or complaints, contact:
<a href="mailto:support@support.com">support@support.com</a> <br>`,
    download_title: "Download",
    download_windows: "Windows",
    recommended: "Recommended",
    win_step1: "Download the installer by clicking the button below",
    win_step2: "Run it and follow the instructions",
    download_installer: "Download Installer",
    download_mac: "macOS",
    mac_note: "on Intel (x64) processors or via Rosetta",
    mac_step1: "Download the image by clicking the button below",
    mac_step2: "Open it and install the launcher",
    download_image: "Download Image",
    download_java: "Manual Java Installation",
    java_step1: "Download and install the latest Java version for your platform, for example from <a href=\"https://adoptium.net/\" target=\"_blank\">Adoptium</a>",
    java_step2: "Download and run the launcher <a href=\"https://dl.llaun.ch/legacy/bootstrap\">.jar file.</a> It will install everything needed",
    about_title: "About the Project",
    about_text: `This project was created by students of 
    <a href="https://intc.kz/ru/" target="_blank">Innovative Technical College, Almaty</a> — 
    Aitmatov Samandar and Ismailov Asanali.  
    The goal of the project is to demonstrate web development skills, achieve the highest grade, and earn an increased scholarship.`,
    about_samandar: "Aitmatov Samandar",
    about_asanali: "Ismailov Asanali",
    about_contacts: "Contacts:",
    footer_about: "© 2025 Minecraft Launcher. A project for the Innovative Technical College.",
    about_btn: "About Us"
  },
  kz: {
    logo: "Minecraft Launcher",
    ely_profile: "Ely.by <u>профилі</u>",
    main_title: "Minecraft Launcher",
    main_subtitle: "Тұрақты, жылдам және қарапайым",
    download_win: "Лаунчерді жүктеу",
    play_online: "Онлайн ойнау",
    players_today: "бүгінгі ойыншылар",
    players_online: "онлайн ойыншылар",
    players_month: "ай ішіндегі ойыншылар",
    screenshots: "Скриншоттар",
    faq_title: "Жиі қойылатын сұрақтар",
    faq_q1: "Бұл тегін бе?",
    faq_a1: "Иә, лаунчер толығымен тегін.<br>Бізде ақылы мүмкіндіктер болған емес және болмайды.",
    faq_q2: "Вирус бар ма?",
    faq_a2_1: "Minecraft Launcher толығымен қауіпсіз. Егер сіз оны осы беттен жүктесеңіз, онда вирустар болмайтынына кепілдік береміз.",
    faq_a2_2: 'Қауіпсіздікке алаңдайсыз ба? Лаунчердің бастапқы коды <a href="https://dl.llaun.ch/legacy/source">мына сілтемеде</a> қолжетімді.',
    faq_q3: "Чит орнатуға бола ма?",
    faq_a3: "Иә, лаунчер кез келген нұсқаны шектеусіз іске қосуға мүмкіндік береді.<br>Тыйым салынған жерлерде чит қолдануды ұсынбаймыз.",
    faq_q4: "Модтар мен жинақтарды орнатуға бола ма?",
    faq_a4: "Иә. Лаунчер Forge және Fabric нұсқаларын қолдайды, сондай-ақ өз жинақтарыңызды қолмен орната аласыз.",
    faq_q5: "Скиндерді өзгертуге бола ма?",
    faq_a5: "Әрине! Ол үшін Ely.by профилін қолдана аласыз, ол экранның жоғарғы оң жақ бұрышындағы батырма арқылы қолжетімді.",
    faq_q6: "Портативті нұсқасы бар ма?",
    faq_a6: 'Иә, бар. <a href="https://dl.llaun.ch/legacy/portable">осы жерден жүктеуге болады</a>.',
    faq_q7: "Ойын іске қосылмайды. Не істеу керек?",
    faq_a7: "Төмендегі тегін қолдау қызметіне хабарласыңыз.",
    support_title: "Қолдау",
    support_text: "Егер бірдеңе жұмыс істемесе немесе күткендей болмаса, бізге әрқашан хабарласа аласыз.<br>Біздің тәжірибелі әзірлеушілер мен еріктілер тобы сізге көмектесуге тырысады.",
    form_title: "Қолдау қызметіне хабарласу",
    form_name: "Атыңыз",
    form_email: "Email",
    form_message: "Хабарлама",
    form_send: "Жіберу",
    vk: "ВКонтакте",
    footer_text: `Ойынға 6+ жас шектеуі қойылған. Сервер иелері контентті анықтайды,<br>ол балаларға сәйкес келмеуі мүмкін. 
<a href="https://www.minecraft.net/kk-kk/get-minecraft/age-rating" target="_blank">
Minecraft сайтынан жас шектеулері туралы көбірек біліңіз.
</a> <br>
MINECRAFT-тың РЕСМИ ӨНІМІ ЕМЕС. MOJANG НЕМЕСЕ MICROSOFT ПЕН БАЙЛАНЫСТЫ ЕМЕС. <br>
Minecraft Launcher Mojang Studios-пен байланысты емес және ресми жоба болып саналмайды. <br>
Сұрақтар, ұсыныстар немесе шағымдар бойынша хабарласыңыз:
<a href="mailto:support@support.com">support@support.com</a> <br>`,
    download_title: "Жүктеу",
    download_windows: "Windows",
    recommended: "Ұсынылады",
    win_step1: "Орнатқышты төмендегі батырма арқылы жүктеп алыңыз",
    win_step2: "Оны іске қосып, нұсқауларды орындаңыз",
    download_installer: "Орнатқышты жүктеу",
    download_mac: "macOS",
    mac_note: "Intel (x64) процессорларында немесе Rosetta арқылы",
    mac_step1: "Образды төмендегі батырма арқылы жүктеп алыңыз",
    mac_step2: "Оны ашып, лаунчерді орнатыңыз",
    download_image: "Образды жүктеу",
    download_java: "Java-ны қолмен орнату",
    java_step1: "<a href=\"https://adoptium.net/\" target=\"_blank\">Adoptium</a> сияқты сайттан соңғы Java нұсқасын жүктеп орнатыңыз",
    java_step2: "Лаунчердің <a href=\"https://dl.llaun.ch/legacy/bootstrap\">.jar файлын</a> жүктеп іске қосыңыз. Ол қажетті нәрселерді орнатады",
    about_title: "Жоба туралы",
    about_text: `Бұл жоба 
    <a href="https://intc.kz/ru/" target="_blank">Алматы қаласының Инновациялық техникалық колледжі</a> студенттері — 
    Айтматов Самандар мен Исмаилов Асанали тарапынан жасалды.  
    Жобаның мақсаты — веб-әзірлеу дағдыларын көрсету, жоғары балл алу және көтеріңкі стипендияға шығу.`,
    about_samandar: "Айтматов Самандар",
    about_asanali: "Исмаилов Асанали",
    about_contacts: "Байланыс:",
    footer_about: "© 2025 Minecraft Launcher. Инновациялық техникалық колледж үшін жоба.",
    about_btn: "Біз туралы"
  }
};

let currentLang = "ru";

function updateTranslations() {
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (translations[currentLang] && translations[currentLang][key] !== undefined) {
      el.innerHTML = translations[currentLang][key];
    }
  });
  document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
    const key = el.getAttribute("data-i18n-placeholder");
    if (translations[currentLang] && translations[currentLang][key] !== undefined) {
      el.placeholder = translations[currentLang][key];
    }
  });
}

document.addEventListener("DOMContentLoaded", function() {
  const langs = ["ru", "en", "kz"];
  const langToggles = document.querySelectorAll("#langToggleDesktop, #langToggleMobile");

  function updateToggleText() {
    langToggles.forEach(b => {
      if (currentLang === "ru") b.textContent = "EN";
      else if (currentLang === "en") b.textContent = "KZ";
      else b.textContent = "RU";
    });
  }

  if (langToggles.length) {
    updateToggleText();
    langToggles.forEach(btn => {
      btn.addEventListener("click", () => {
        let idx = langs.indexOf(currentLang);
        currentLang = langs[(idx + 1) % langs.length];
        updateToggleText();
        updateTranslations();
      });
    });
  }

  document.querySelectorAll(".faq-question").forEach(btn => {
    btn.addEventListener("click", () => {
      const answer = btn.nextElementSibling;
      btn.classList.toggle("active");
      if (answer) answer.classList.toggle("open");
    });
  });

  const viewer = document.querySelector(".screenshot-viewer");
  if (viewer) {
    const screenshots = [
      "./assets/screen1.png",
      "./assets/screen2.png",
      "./assets/screen3.png"
    ];
    let currentIndex = 0;
    let isAnimating = false;
    const duration = 550;
    const imgA = document.createElement("img");
    const imgB = document.createElement("img");
    imgA.src = screenshots[0];
    imgA.className = "screenshot active";
    imgB.className = "screenshot next";
    viewer.innerHTML = "";
    viewer.appendChild(imgA);
    viewer.appendChild(imgB);

    function finalizeTransition(incomingImg, currentImg, targetIndex) {
      if (currentImg) {
        currentImg.classList.remove("active");
        currentImg.classList.add("next");
        currentImg.style.transform = "";
        currentImg.style.opacity = "0";
      }
      incomingImg.classList.remove("next");
      incomingImg.classList.add("active");
      incomingImg.style.transform = "";
      incomingImg.style.opacity = "1";
      currentIndex = targetIndex;
      isAnimating = false;
    }

    function showScreenshot(targetIndex, direction) {
      if (isAnimating || targetIndex === currentIndex) return;
      isAnimating = true;
      const currentImg = viewer.querySelector(".screenshot.active");
      const incomingImg = viewer.querySelector(".screenshot.next");
      incomingImg.src = screenshots[targetIndex];
      incomingImg.style.transition = "none";
      if (currentImg) currentImg.style.transition = "none";
      incomingImg.style.transform = (direction === "next") ? "translateX(100%)" : "translateX(-100%)";
      incomingImg.style.opacity = "1";
      void incomingImg.offsetWidth;
      incomingImg.style.transition = `transform ${duration}ms cubic-bezier(.22,.95,.35,1)`;
      if (currentImg) currentImg.style.transition = `transform ${duration}ms cubic-bezier(.22,.95,.35,1), opacity ${duration}ms ease`;
      if (direction === "next") {
        if (currentImg) currentImg.style.transform = "translateX(-100%)";
      } else {
        if (currentImg) currentImg.style.transform = "translateX(100%)";
      }
      if (currentImg) currentImg.style.opacity = "0.5";
      incomingImg.style.transform = "translateX(0)";
      let finished = false;
      function onEnd(e) {
        if (e.propertyName !== "transform") return;
        if (finished) return;
        finished = true;
        incomingImg.removeEventListener("transitionend", onEnd);
        finalizeTransition(incomingImg, currentImg, targetIndex);
        clearTimeout(fallback);
      }
      incomingImg.addEventListener("transitionend", onEnd);
      const fallback = setTimeout(() => {
        if (!finished) {
          incomingImg.removeEventListener("transitionend", onEnd);
          finalizeTransition(incomingImg, currentImg, targetIndex);
        }
      }, duration + 120);
    }

    function nextScreenshot() {
      let nextIndex = (currentIndex + 1) % screenshots.length;
      showScreenshot(nextIndex, "next");
    }
    setInterval(nextScreenshot, 5000);
  }

  const contactForm = document.getElementById("contactForm");
  const formStatus = document.getElementById("formStatus");
  if (contactForm) {
    contactForm.addEventListener("submit", function(e) {
      e.preventDefault();
      const name = (document.getElementById("name") || {}).value?.trim() || "";
      const email = (document.getElementById("email") || {}).value?.trim() || "";
      const message = (document.getElementById("message") || {}).value?.trim() || "";
      if (!name || !email || !message) {
        if (formStatus) {
          formStatus.textContent = currentLang === "ru" ? "Заполните все поля" : currentLang === "en" ? "Fill in all fields" : "Барлық өрістерді толтырыңыз";
          formStatus.style.color = "#f6b1b1";
        }
        return;
      }
      if (formStatus) {
        formStatus.textContent = currentLang === "ru" ? "Отправлено — спасибо!" : currentLang === "en" ? "Sent — thank you!" : "Жіберілді — рақмет!";
        formStatus.style.color = "#aee0a9";
      }
      contactForm.reset();
      setTimeout(() => { if (formStatus) formStatus.textContent = ""; }, 4000);
    });
  }

  const menuToggle = document.querySelector(".menu-toggle");
  const mobileMenu = document.querySelector(".mobile-menu");
  if (menuToggle && mobileMenu) {
    menuToggle.addEventListener("click", (e) => {
      e.stopPropagation();
      mobileMenu.style.display = mobileMenu.style.display === "flex" ? "none" : "flex";
    });
    document.addEventListener("click", (e) => {
      if (!mobileMenu.contains(e.target) && !menuToggle.contains(e.target)) {
        mobileMenu.style.display = "none";
      }
    });
  }

  updateTranslations();
});
